var vjAcc="";var wrUrl="http://c.wrating.com/";var wrDomain="";var wrSv=1000000;document.write('<div style="display:none"><img id="wrTagImage" width="1" height="1" /></div>');function vjTrack(jsParam){var b=1800;var c=false;var d=false;var e="";var f="0";var g="";var h;var i;var j;var k;var l;var m="expires=Fri, 1 Jan 2038 00:00:00 GMT;";var n=0;if(document.location.protocol=="file:")return;c=navigator.cookieEnabled?"1":"0";d=navigator.javaEnabled()?"1":"0";var o="0";var p;var r=-1;var q=document.cookie;if(wrDomain==""){var dmEle=document.domain.split(".");var dmEleLen = dmEle.length;var tmpDm = dmEle[dmEleLen-2]+"."+dmEle[dmEleLen-1];if (tmpDm == "com.cn" || tmpDm == "net.cn" || tmpDm == "org.cn" || tmpDm == "gov.cn"){ wrDomain =  dmEle[dmEleLen-3]+"."+dmEle[dmEleLen-2]+"."+dmEle[dmEleLen-1];}else if (dmEle[dmEleLen-1] == "cn" || dmEle[dmEleLen-1] == "com" || dmEle[dmEleLen-1] == "net" || dmEle[dmEleLen-1] == "gov" || dmEle[dmEleLen-1] == "org"){wrDomain=dmEle[dmEleLen-2]+"."+dmEle[dmEleLen-1];}else{wrDomain=document.domain;}}if(c=="1"){r=q.indexOf("vjuids=");if(r<0){p=vjVisitorID();document.cookie="vjuids="+escape(p)+";"+m+";domain="+wrDomain+";path=/;";if(document.cookie.indexOf("vjuids=")<0)c="0";else{ c="1";f="1";}}else{p=vjGetCookie("vjuids");}};i=document.referrer;if(!i||i==""){var nv=navigator.appName+" "+navigator.appVersion;if((nv.indexOf('MSIE')>=0)&&(parseInt(nv.substr(nv.indexOf('MSIE')+5))>=5)&&(nv.indexOf('Mac')==-1)&&(navigator.userAgent.indexOf('Opera')==-1)){document.body.addBehavior("#default#homePage");i=(document.body.isHomePage(location.href))?"ishomepage":"";}};e=vjFlash();if(self.screen){h=screen.width+"x"+screen.height+"x"+screen.colorDepth;}else if(self.java){var t=java.awt.Toolkit.getDefaultToolkit();var s=t.getScreenSize();h=s.width+"x"+s.height+"x0";};if(navigator.language){j=navigator.language.toLowerCase();}else if(navigator.browserLanguage){j=navigator.browserLanguage.toLowerCase();}else{j="-";};var u;var curtime;curtime=new Date();k=curtime.getTimezoneOffset()/-60;k=curtime.getTimezoneOffset()/-60;u="&s="+h+"&l="+j+"&z="+k+"&j="+d+"&f="+e;if(c=="1"){r=document.cookie.indexOf("vjlast=");if(r<0){n=0;}else{n=parseInt(vjGetCookie("vjlast"));};if((curtime.getTime()/1000)-n>b)o="1";document.cookie="vjlast="+Math.round(curtime.getTime()/1000)+";"+m+";domain="+wrDomain+";path=/;";};if(i!=""){u=u+"&r="+escape(i);};if(o!="0"){u=u+"&n="+n;};if(f!="0"){u=u+"&u="+f;};var tagimage;tagimage=wrUrl+"a.gif?a="+curtime.getTime().toString(16)+"&t="+"&i="+escape(p)+"&b="+escape(document.location)+"&c="+vjAcc+u+"&js="+escape(jsParam)+"&ck="+c;var random=Math.round(wrSv*Math.random());if(random == 0){var wrJs='<scr'+'ipt language="JavaScript" type="text/javascript" src="http://www.wrating.com/survey/check.php?c='+vjAcc+'&uid='+escape(p)+'"><\/scr'+'ipt>';document.write(wrJs);}document.getElementById('wrTagImage').src = tagimage;};function vjFlash(){var f="-",n=navigator;if(n.plugins&&n.plugins.length){for(var ii=0;ii<n.plugins.length;ii++){if(n.plugins[ii].name.indexOf('Shockwave Flash')!=-1){f=n.plugins[ii].description.split('Shockwave Flash ')[1];break;}}}else if(window.ActiveXObject){for(var ii=10;ii>=2;ii--){try{var fl=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+ii+"');");if(fl){f=ii+'.0';break;}}catch(e){}}};return f;};function vjHash(s){if(!s||s=="")return 0;var h=0;for(var i=s.length-1;i>=0;i--){var c=parseInt(s.charCodeAt(i));h=(h<<5)+h+c;};return h;};function vjVisitorID(){var urlhash=vjHash(document.location+document.cookie+document.referrer).toString(16);var curtime;curtime=new Date();return urlhash+"."+curtime.getTime().toString(16)+"."+Math.random().toString(16);};function vjGetCookieVal(offset){var endstr=document.cookie.indexOf(";",offset);if(endstr==-1)endstr=document.cookie.length;return unescape(document.cookie.substring(offset,endstr));};function vjGetCookie(name){var arg=name+"=";var alen=arg.length;var clen=document.cookie.length;var i=0;while(i<clen){var j=i+alen;if(document.cookie.substring(i,j)==arg)return vjGetCookieVal(j);i=document.cookie.indexOf(" ",i)+1;if(i==1)break;};return null;}